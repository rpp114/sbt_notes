<!-- from base layout -->

{% extends 'base.html' %}

{% block content %}
  <h3>Invoice for {{rc.name}} for {{start_date.strftime('%b %Y')}}</h3>
  {% if file_link %}
  <a href="{{file_link}}" download><h4>Download Invoice</h4></a>
  {% else %}
    <form action="" method="post">
      <input type="submit" value="Create XML" />
    </form>
  {% endif %}

  <table border="1px black" class="table is-stripped is-bordered is-narrow">
    <tr>
      <th style="text-align:center">Client</th>
      <th style="text-align:center">Appt Type</th>
      <th style="text-align:center">Total Appts</th>
      <th style="text-align:center">Total Amount</th>
      {% for day in range(days) %}
        <th style="text-align:center">
          {{ day + 1 }}
        </th>
      {% endfor %}
    </tr>
    {% for appt in appts_for_grid %}
    <tr>
      <td style="text-align:center">
        <a href="/client/appts?client_id={{appt['client_id']}}&start_date={{appt['start_date'].strftime('%Y-%m-%d')}}&end_date={{appt['end_date'].strftime('%Y-%m-%d')}}">{{ appt.firstname }} {{ appt.lastname }}</a>
      </td>
      <td style="text-align:center">{{ appt.appt_type }}</td>
      <td style="text-align:center">{{ appt.total_appts }}</td>
      <td style="text-align:center">${{ appt.total_amount }}</td>
      {% for count in appt.appts %}
        <td style="text-align:center">{{ count }}</td>
      {% endfor %}
    </tr>
    {% endfor %}

    <tr>
      <td></td>
      <td style="text-align:right"><strong>Totals:</strong></td>
      <td style="text-align:center"><strong>{{appt_count}}</strong></td>
      <td style="text-align:center"><strong>${{'%0.2f'|format(appt_amount|float)}}</strong></td>
      {% for day in daily_totals %}
        {% if day == 0 %}
          <td></td>
        {% else %}
          <td style="text-align:center"><strong>{{day}}</strong></td>
        {% endif %}
      {% endfor %}

    </tr>
  </table>

    {% for client in notes %}
      <p><strong>{{notes[client]['name']}}</strong></p>
      <ul>
      {% for note in notes[client]['notes']%}
        <li> {{note}}</li>
      {% endfor %}
      </ul>
    {% endfor %}
{% endblock %}

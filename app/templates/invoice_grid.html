<!-- from base layout -->

{% extends 'base.html' %}

{% block content %}

<script>
$(document).ready(function(){
  $(".table-data").click(function() {
    if ($(this).hasClass('is-selected')){
      $(this).toggleClass('is-selected')
    } else {
      $(".table-data").removeClass('is-selected');
      $(this).toggleClass('is-selected');
    }
  })
})
</script>

<div class="content">

</div>
  <div class="level">
    <div class="level-left">
      <div class="level-item">
        <h3 class="title is-5">Invoice for {{rc.name}} for {{start_date.strftime('%b %Y')}}</h3>
      </div>
      <div class="level-item">
      {% if file_link %}
      <br />
      <a href="{{file_link}}" download><h4 class="subtitle is-7">Download Invoice</h4></a>
      {% else %}
      <form action="" method="post">
        <input type="submit" class="button is-small is-primary" value="Create XML" />
      </form>
      {% endif %}
    </div>
    </div>
  </div>

  <table border="1px black" class="table is-stripped is-bordered is-narrow" id="appt-table">
    <tr>
      <th style="text-align:center" class="is-size-7">Client</th>
      <th style="text-align:center" class="is-size-7">Appt Type</th>
      <th style="text-align:center" class="is-size-7">Total Appts</th>
      <th style="text-align:center" class="is-size-7">Total Amount</th>
      {% for day in range(days) %}
        <th style="text-align:center" class="is-size-7">
          {{ day + 1 }}
        </th>
      {% endfor %}
    </tr>
    {% for appt in appts_for_grid %}
    <tr class="table-data" >
      <td style="text-align:center;" class="is-size-7">
        <a href="/client/appts?client_id={{appt['client_id']}}&start_date={{appt['start_date'].strftime('%Y-%m-%d')}}&end_date={{appt['end_date'].strftime('%Y-%m-%d')}}">{{ appt.firstname }} {{ appt.lastname }}</a>
      </td>
      <td style="text-align:center;" class="is-size-7">{{ appt.appt_type }}</td>
      <td style="text-align:center;" class="is-size-7">{{ appt.total_appts }}</td>
      <td style="text-align:center;" class="is-size-7">${{ appt.total_amount }}</td>
      {% for count in appt.appts %}
        <td style="text-align:center;" class="is-size-7">{{ count }}</td>
      {% endfor %}
    </tr>
    {% endfor %}

    <tr>
      <td></td>
      <td style="text-align:right" class="is-size-7"><strong>Totals:</strong></td>
      <td style="text-align:center;" class="is-size-7"><strong>{{appt_count}}</strong></td>
      <td style="text-align:center;" class="is-size-7"><strong>${{'%0.2f'|format(appt_amount|float)}}</strong></td>
      {% for day in daily_totals %}
        {% if day == 0 %}
          <td></td>
        {% else %}
          <td style="text-align:center" class="is-size-7"><strong>{{day}}</strong></td>
        {% endif %}
      {% endfor %}

    </tr>
  </table>

    {% for client in notes %}
      <p><strong>{{notes[client]['name']}}</strong></p>
      <ul>
      {% for note in notes[client]['notes']%}
        <li> {{note}}</li>
      {% endfor %}
      </ul>
    {% endfor %}
{% endblock %}
